<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BusBook - Bus Booking & Live Tracking System</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    .seat {
      width: 40px;
      height: 40px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 500;
    }
    .seat.available {
      background: #e0f2fe;
      border: 1px solid #bae6fd;
    }
    .seat.selected {
      background: #0ea5e9;
      color: white;
      border: 1px solid #0284c7;
    }
    .seat.booked {
      background: #f8fafc;
      color: #64748b;
      border: 1px solid #cbd5e1;
      cursor: not-allowed;
    }
    .tracking-point {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #ef4444;
      position: absolute;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0% { transform: scale(0.95); opacity: 0.8; }
      50% { transform: scale(1.1); opacity: 1; }
      100% { transform: scale(0.95); opacity: 0.8; }
    }
    .map-container {
      height: 400px;
      background: linear-gradient(135deg, #61dafb 0%, #1e40af 100%);
      border-radius: 12px;
      position: relative;
      overflow: hidden;
    }
    .route-line {
      position: absolute;
      height: 4px;
      background: #ef4444;
      transform: translateY(-2px);
      border-radius: 2px;
    }
    .bus-icon {
      width: 32px;
      height: 32px;
      background: #059669;
      color: white;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>
<body x-data="app" class="bg-gray-50 min-h-screen font-sans">
  <!-- Main App Container -->
  <div class="max-w-6xl mx-auto px-4 py-6">
    <!-- Header -->
    <header class="bg-white shadow-lg rounded-2xl mb-6">
      <div class="px-6 py-4 flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl flex items-center justify-center">
            <i class="fas fa-bus text-white"></i>
          </div>
          <div>
            <h1 class="text-xl font-bold text-gray-800">BusBook</h1>
            <p class="text-sm text-gray-500">Bus Booking & Live Tracking</p>
          </div>
        </div>
        
        <div class="flex items-center space-x-4">
          <button @click="view = 'customer'" :class="{'bg-blue-100 text-blue-700': view === 'customer'}" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-700 hover:bg-blue-50 transition">
            Customer View
          </button>
          <button @click="view = 'admin'" :class="{'bg-blue-100 text-blue-700': view === 'admin'}" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-700 hover:bg-blue-50 transition">
            Admin Panel
          </button>
          
          <div x-show="isLoggedIn" class="flex items-center space-x-2">
            <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center">
              <span class="text-white text-sm font-medium">{{ user.name.charAt(0) }}</span>
            </div>
            <button @click="logout" class="text-gray-500 hover:text-red-500">
              <i class="fas fa-sign-out-alt"></i>
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Login Screen -->
    <div x-show="!isLoggedIn" class="bg-white rounded-2xl shadow-xl p-8 max-w-md mx-auto">
      <div class="text-center mb-6">
        <h2 class="text-2xl font-bold text-gray-800 mb-2">Welcome to BusBook</h2>
        <p class="text-gray-600">Login to access your account</p>
      </div>
      
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
          <input type="tel" x-model="login.phone" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your phone number">
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">Password</label>
          <input type="password" x-model="login.password" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Enter your password">
        </div>
        
        <button @click="loginUser" class="w-full bg-gradient-to-r from-blue-500 to-cyan-500 text-white py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-cyan-600 transition transform hover:scale-105">
          Login
        </button>
        
        <div class="text-center text-sm text-gray-500">
          <p>Use any phone number and password to login</p>
        </div>
      </div>
    </div>

    <!-- Customer View -->
    <div x-show="isLoggedIn && view === 'customer'" class="space-y-6">
      <!-- Search Section -->
      <div class="bg-white rounded-2xl shadow-lg p-6">
        <h2 class="text-xl font-bold text-gray-800 mb-4">Book Your Journey</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">From</label>
            <select x-model="search.from" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
              <option value="Delhi">Delhi</option>
              <option value="Mumbai">Mumbai</option>
              <option value="Bangalore">Bangalore</option>
              <option value="Chennai">Chennai</option>
              <option value="Kolkata">Kolkata</option>
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">To</label>
            <select x-model="search.to" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
              <option value="Mumbai">Mumbai</option>
              <option value="Delhi">Delhi</option>
              <option value="Bangalore">Bangalore</option>
              <option value="Chennai">Chennai</option>
              <option value="Kolkata">Kolkata</option>
            </select>
          </div>
          
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">Date</label>
            <input type="date" x-model="search.date" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
          </div>
          
          <div class="flex items-end">
            <button @click="searchBuses" class="w-full bg-gradient-to-r from-blue-500 to-cyan-500 text-white py-3 rounded-xl font-semibold hover:from-blue-600 hover:to-cyan-600 transition">
              Search
            </button>
          </div>
        </div>
      </div>

      <!-- Results Section -->
      <div x-show="searchResults.length > 0" class="space-y-4">
        <div class="bg-white rounded-2xl shadow-lg p-6">
          <h3 class="text-lg font-bold text-gray-800 mb-4">Available Buses</h3>
          
          <div class="space-y-4">
            <template x-for="bus in searchResults" :key="bus.id">
              <div class="border border-gray-200 rounded-xl p-4 hover:shadow-md transition">
                <div class="flex items-center justify-between mb-3">
                  <div class="flex items-center space-x-3">
                    <div class="w-12 h-12 bg-gradient-to-r from-green-400 to-blue-500 rounded-xl flex items-center justify-center">
                      <i class="fas fa-bus text-white"></i>
                    </div>
                    <div>
                      <h4 class="font-bold text-gray-800" x-text="bus.name"></h4>
                      <p class="text-sm text-gray-500" x-text="bus.type"></p>
                    </div>
                  </div>
                  <div class="text-right">
                    <p class="text-lg font-bold text-gray-800" x-text="'₹' + bus.fare"></p>
                    <p class="text-sm text-green-600" x-text="bus.seatsAvailable + ' seats left'"></p>
                  </div>
                </div>
                
                <div class="flex items-center justify-between text-sm text-gray-600">
                  <span x-text="bus.departure + ' → ' + bus.arrival"></span>
                  <span x-text="bus.duration + ' journey'"></span>
                </div>
                
                <div class="mt-4 flex space-x-2">
                  <button @click="selectBus(bus)" class="flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg font-medium hover:bg-blue-600 transition">
                    Select Bus
                  </button>
                  <button @click="trackBus(bus)" class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition flex items-center space-x-1">
                    <i class="fas fa-map-marker-alt"></i>
                    <span>Track</span>
                  </button>
                </div>
              </div>
            </template>
          </div>
        </div>
      </div>

      <!-- Seat Selection -->
      <div x-show="selectedBus" class="bg-white rounded-2xl shadow-lg p-6">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-bold text-gray-800">Select Your Seats</h3>
          <button @click="selectedBus = null" class="text-gray-500 hover:text-gray-700">
            <i class="fas fa-times"></i>
          </button>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <div class="lg:col-span-2">
            <div class="bg-gray-100 p-4 rounded-xl">
              <div class="flex justify-between items-center mb-4">
                <h4 class="font-bold text-gray-800" x-text="selectedBus?.name"></h4>
                <div class="text-sm text-gray-600">
                  <span x-text="selectedBus?.seatsAvailable + ' available'"></span>
                </div>
              </div>
              
              <!-- Seat Layout -->
              <div class="flex flex-wrap gap-2 justify-center mb-4">
                <template x-for="seat in Array(40).keys()">
                  <div 
                    :class="{
                      'seat': true,
                      'available': !selectedBus?.bookedSeats.includes(seat + 1),
                      'selected': selectedSeats.includes(seat + 1),
                      'booked': selectedBus?.bookedSeats.includes(seat + 1)
                    }"
                    x-show="(seat + 1) <= selectedBus?.totalSeats"
                    @click="toggleSeat(seat + 1)"
                    x-text="seat + 1"
                  ></div>
                </template>
              </div>
              
              <div class="flex justify-center space-x-6 text-sm text-gray-600">
                <div class="flex items-center space-x-2">
                  <div class="w-4 h-4 bg-blue-100 border border-blue-300 rounded"></div>
                  <span>Available</span>
                </div>
                <div class="flex items-center space-x-2">
                  <div class="w-4 h-4 bg-blue-500 rounded"></div>
                  <span>Selected</span>
                </div>
                <div class="flex items-center space-x-2">
                  <div class="w-4 h-4 bg-gray-100 border border-gray-300 rounded"></div>
                  <span>Booked</span>
                </div>
              </div>
            </div>
          </div>
          
          <div>
            <div class="bg-gray-50 rounded-xl p-4">
              <h4 class="font-bold text-gray-800 mb-3">Booking Summary</h4>
              
              <div class="space-y-2 mb-4">
                <div class="flex justify-between text-sm">
                  <span class="text-gray-600">Route</span>
                  <span x-text="search.from + ' → ' + search.to"></span>
                </div>
                <div class="flex justify-between text-sm">
                  <span class="text-gray-600">Date</span>
                  <span x-text="search.date"></span>
                </div>
                <div class="flex justify-between text-sm">
                  <span class="text-gray-600">Bus</span>
                  <span x-text="selectedBus?.name"></span>
                </div>
                <div class="flex justify-between text-sm">
                  <span class="text-gray-600">Seats</span>
                  <span x-text="selectedSeats.join(', ') || 'None'"></span>
                </div>
                <div class="flex justify-between text-sm font-bold pt-2 border-t">
                  <span>Total</span>
                  <span x-text="'₹' + (selectedBus?.fare * selectedSeats.length || 0)"></span>
                </div>
              </div>
              
              <button 
                @click="bookSeats" 
                :disabled="selectedSeats.length === 0"
                class="w-full bg-gradient-to-r from-green-500 to-blue-500 text-white py-3 rounded-lg font-semibold hover:from-green-600 hover:to-blue-600 transition disabled:opacity-50 disabled:cursor-not-allowed"
                x-text="selectedSeats.length === 0 ? 'Select Seats First' : 'Proceed to Payment'"
              ></button>
            </div>
          </div>
        </div>
      </div>

      <!-- Booking Confirmation -->
      <div x-show="bookingConfirmed" class="bg-white rounded-2xl shadow-lg p-6">
        <div class="text-center">
          <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <i class="fas fa-check-circle text-green-500 text-3xl"></i>
          </div>
          <h3 class="text-xl font-bold text-gray-800 mb-2">Booking Confirmed!</h3>
          <p class="text-gray-600 mb-4">Your booking has been successfully confirmed</p>
          
          <div class="bg-gray-50 rounded-xl p-4 mb-4">
            <div class="grid grid-cols-2 gap-4 text-sm">
              <div>
                <span class="text-gray-500">Booking ID</span>
                <p class="font-medium" x-text="currentBooking.id"></p>
              </div>
              <div>
                <span class="text-gray-500">Date</span>
                <p class="font-medium" x-text="currentBooking.date"></p>
              </div>
              <div>
                <span class="text-gray-500">Route</span>
                <p class="font-medium" x-text="currentBooking.route"></p>
              </div>
              <div>
                <span class="text-gray-500">Seats</span>
                <p class="font-medium" x-text="currentBooking.seats"></p>
              </div>
              <div>
                <span class="text-gray-500">Bus</span>
                <p class="font-medium" x-text="currentBooking.bus"></p>
              </div>
              <div>
                <span class="text-gray-500">Total</span>
                <p class="font-medium" x-text="currentBooking.total"></p>
              </div>
            </div>
          </div>
          
          <div class="flex space-x-3">
            <button @click="bookingConfirmed = false; currentBooking = {}" class="flex-1 bg-gray-500 text-white py-3 rounded-lg font-medium hover:bg-gray-600 transition">
              Done
            </button>
            <button class="flex-1 bg-blue-500 text-white py-3 rounded-lg font-medium hover:bg-blue-600 transition">
              Download Ticket
            </button>
          </div>
        </div>
      </div>

      <!-- Live Tracking View -->
      <div x-show="trackingBus" class="bg-white rounded-2xl shadow-lg p-6">
        <div class="flex items-center justify-between mb-4">
          <h3 class="text-lg font-bold text-gray-800">Live Tracking - <span x-text="trackingBus?.name"></span></h3>
          <button @click="trackingBus = null" class="text-gray-500 hover:text-gray-700">
            <i class="fas fa-times"></i>
          </button>
        </div>
        
        <div class="map-container mb-4">
          <!-- Simplified Map Visualization -->
          <div class="absolute top-8 left-8 text-white font-medium" x-text="search.from"></div>
          <div class="absolute top-8 right-8 text-white font-medium" x-text="search.to"></div>
          
          <!-- Route Line -->
          <div class="route-line" style="width: 80%; left: 10%; top: 50%;"></div>
          
          <!-- Bus Position -->
          <div class="absolute" :style="{ left: trackingProgress + '%', top: '48%' }">
            <div class="bus-icon">🚌</div>
          </div>
          
          <!-- Tracking Point -->
          <div class="tracking-point" :style="{ left: trackingProgress + '%', top: '48%' }"></div>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div class="bg-blue-50 p-4 rounded-xl">
            <div class="text-sm text-blue-600 font-medium">Current Location</div>
            <div class="text-lg font-bold text-blue-800" x-text="currentLocation"></div>
          </div>
          <div class="bg-green-50 p-4 rounded-xl">
            <div class="text-sm text-green-600 font-medium">Estimated Arrival</div>
            <div class="text-lg font-bold text-green-800" x-text="estimatedArrival"></div>
          </div>
          <div class="bg-orange-50 p-4 rounded-xl">
            <div class="text-sm text-orange-600 font-medium">Status</div>
            <div class="text-lg font-bold text-orange-800" x-text="busStatus"></div>
          </div>
        </div>
      </div>

      <!-- My Bookings -->
      <div x-show="!selectedBus && !bookingConfirmed && !trackingBus" class="bg-white rounded-2xl shadow-lg p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-4">My Bookings</h3>
        
        <div x-show="userBookings.length === 0" class="text-center py-8 text-gray-500">
          <i class="fas fa-ticket-alt text-4xl mb-3 opacity-50"></i>
          <p>No bookings yet. Start your journey!</p>
        </div>
        
        <div x-show="userBookings.length > 0" class="space-y-4">
          <template x-for="booking in userBookings" :key="booking.id">
            <div class="border border-gray-200 rounded-xl p-4">
              <div class="flex items-center justify-between mb-2">
                <h4 class="font-bold text-gray-800" x-text="booking.bus"></h4>
                <span class="px-3 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full" x-text="booking.status"></span>
              </div>
              
              <div class="grid grid-cols-2 gap-4 text-sm text-gray-600 mb-3">
                <div>
                  <span>Date: </span>
                  <span x-text="booking.date"></span>
                </div>
                <div>
                  <span>Route: </span>
                  <span x-text="booking.route"></span>
                </div>
                <div>
                  <span>Seats: </span>
                  <span x-text="booking.seats"></span>
                </div>
                <div>
                  <span>Total: </span>
                  <span x-text="booking.total"></span>
                </div>
              </div>
              
              <div class="flex space-x-2">
                <button class="flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg text-sm font-medium hover:bg-blue-600 transition">
                  View Ticket
                </button>
                <button class="flex-1 border border-gray-300 text-gray-700 py-2 px-4 rounded-lg text-sm hover:bg-gray-50 transition">
                  Cancel
                </button>
              </div>
            </div>
          </template>
        </div>
      </div>
    </div>

    <!-- Admin Panel -->
    <div x-show="isLoggedIn && view === 'admin'" class="space-y-6">
      <!-- Admin Header -->
      <div class="bg-white rounded-2xl shadow-lg p-6">
        <div class="flex items-center justify-between">
          <h2 class="text-xl font-bold text-gray-800">Admin Dashboard</h2>
          <div class="flex space-x-2">
            <button @click="activeTab = 'buses'" :class="{'bg-blue-100 text-blue-700': activeTab === 'buses'}" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-700 hover:bg-blue-50 transition">
              Buses
            </button>
            <button @click="activeTab = 'bookings'" :class="{'bg-blue-100 text-blue-700': activeTab === 'bookings'}" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-700 hover:bg-blue-50 transition">
              Bookings
            </button>
            <button @click="activeTab = 'tracking'" :class="{'bg-blue-100 text-blue-700': activeTab === 'tracking'}" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-700 hover:bg-blue-50 transition">
              Live Tracking
            </button>
            <button @click="activeTab = 'reports'" :class="{'bg-blue-100 text-blue-700': activeTab === 'reports'}" class="px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:text-blue-700 hover:bg-blue-50 transition">
              Reports
            </button>
          </div>
        </div>
      </div>

      <!-- Buses Management -->
      <div x-show="activeTab === 'buses'" class="bg-white rounded-2xl shadow-lg p-6">
        <div class="flex items-center justify-between mb-6">
          <h3 class="text-lg font-bold text-gray-800">Bus Management</h3>
          <button @click="showAddBus = true" class="bg-blue-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-600 transition flex items-center space-x-1">
            <i class="fas fa-plus"></i>
            <span>Add Bus</span>
          </button>
        </div>
        
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead>
              <tr class="border-b border-gray-200">
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Bus No</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Name</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Type</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Route</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Fare</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Status</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Actions</th>
              </tr>
            </thead>
            <tbody>
              <template x-for="bus in adminBuses" :key="bus.id">
                <tr class="border-b border-gray-100 hover:bg-gray-50">
                  <td class="py-3 px-4" x-text="bus.number"></td>
                  <td class="py-3 px-4" x-text="bus.name"></td>
                  <td class="py-3 px-4" x-text="bus.type"></td>
                  <td class="py-3 px-4" x-text="bus.route"></td>
                  <td class="py-3 px-4" x-text="'₹' + bus.fare"></td>
                  <td class="py-3 px-4">
                    <span :class="{
                      'px-2 py-1 rounded-full text-xs font-medium': true,
                      'bg-green-100 text-green-800': bus.status === 'Active',
                      'bg-red-100 text-red-800': bus.status === 'Inactive',
                      'bg-yellow-100 text-yellow-800': bus.status === 'Maintenance'
                    }" x-text="bus.status"></span>
                  </td>
                  <td class="py-3 px-4">
                    <div class="flex space-x-2">
                      <button @click="editBus(bus)" class="text-blue-600 hover:text-blue-800">
                        <i class="fas fa-edit"></i>
                      </button>
                      <button @click="deleteBus(bus.id)" class="text-red-600 hover:text-red-800">
                        <i class="fas fa-trash"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Add/Edit Bus Modal -->
      <div x-show="showAddBus || editingBus" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
        <div class="bg-white rounded-2xl p-6 w-full max-w-md">
          <div class="flex items-center justify-between mb-4">
            <h3 class="text-lg font-bold text-gray-800" x-text="editingBus ? 'Edit Bus' : 'Add New Bus'"></h3>
            <button @click="showAddBus = false; editingBus = null" class="text-gray-500 hover:text-gray-700">
              <i class="fas fa-times"></i>
            </button>
          </div>
          
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Bus Number</label>
              <input type="text" x-model="busForm.number" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Bus Name</label>
              <input type="text" x-model="busForm.name" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Type</label>
              <select x-model="busForm.type" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <option value="AC Sleeper">AC Sleeper</option>
                <option value="Non-AC Seater">Non-AC Seater</option>
                <option value="Semi-Sleeper">Semi-Sleeper</option>
                <option value="Luxury">Luxury</option>
              </select>
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Route</label>
              <input type="text" x-model="busForm.route" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Fare (₹)</label>
              <input type="number" x-model="busForm.fare" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            </div>
            
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
              <select x-model="busForm.status" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <option value="Active">Active</option>
                <option value="Inactive">Inactive</option>
                <option value="Maintenance">Maintenance</option>
              </select>
            </div>
          </div>
          
          <div class="flex space-x-3 mt-6">
            <button @click="saveBus" class="flex-1 bg-blue-500 text-white py-3 rounded-xl font-semibold hover:bg-blue-600 transition">
              Save
            </button>
            <button @click="showAddBus = false; editingBus = null" class="flex-1 bg-gray-500 text-white py-3 rounded-xl font-semibold hover:bg-gray-600 transition">
              Cancel
            </button>
          </div>
        </div>
      </div>

      <!-- Bookings Management -->
      <div x-show="activeTab === 'bookings'" class="bg-white rounded-2xl shadow-lg p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-6">Booking Management</h3>
        
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
          <div class="bg-blue-50 p-4 rounded-xl">
            <div class="text-sm text-blue-600 font-medium">Total Bookings</div>
            <div class="text-2xl font-bold text-blue-800" x-text="adminBookings.length"></div>
          </div>
          <div class="bg-green-50 p-4 rounded-xl">
            <div class="text-sm text-green-600 font-medium">Confirmed</div>
            <div class="text-2xl font-bold text-green-800" x-text="adminBookings.filter(b => b.status === 'Confirmed').length"></div>
          </div>
          <div class="bg-orange-50 p-4 rounded-xl">
            <div class="text-sm text-orange-600 font-medium">Pending</div>
            <div class="text-2xl font-bold text-orange-800" x-text="adminBookings.filter(b => b.status === 'Pending').length"></div>
          </div>
          <div class="bg-red-50 p-4 rounded-xl">
            <div class="text-sm text-red-600 font-medium">Revenue</div>
            <div class="text-2xl font-bold text-red-800" x-text="'₹' + adminBookings.filter(b => b.status === 'Confirmed').reduce((acc, b) => acc + parseInt(b.total.replace('₹', '')), 0).toLocaleString()"></div>
          </div>
        </div>
        
        <div class="overflow-x-auto">
          <table class="w-full">
            <thead>
              <tr class="border-b border-gray-200">
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Booking ID</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Customer</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Bus</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Date</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Seats</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Total</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Status</th>
                <th class="text-left py-3 px-4 font-semibold text-gray-800">Actions</th>
              </tr>
            </thead>
            <tbody>
              <template x-for="booking in adminBookings" :key="booking.id">
                <tr class="border-b border-gray-100 hover:bg-gray-50">
                  <td class="py-3 px-4" x-text="booking.id"></td>
                  <td class="py-3 px-4" x-text="booking.customer"></td>
                  <td class="py-3 px-4" x-text="booking.bus"></td>
                  <td class="py-3 px-4" x-text="booking.date"></td>
                  <td class="py-3 px-4" x-text="booking.seats"></td>
                  <td class="py-3 px-4" x-text="booking.total"></td>
                  <td class="py-3 px-4">
                    <span :class="{
                      'px-2 py-1 rounded-full text-xs font-medium': true,
                      'bg-green-100 text-green-800': booking.status === 'Confirmed',
                      'bg-yellow-100 text-yellow-800': booking.status === 'Pending',
                      'bg-red-100 text-red-800': booking.status === 'Cancelled'
                    }" x-text="booking.status"></span>
                  </td>
                  <td class="py-3 px-4">
                    <div class="flex space-x-2">
                      <button @click="confirmBooking(booking.id)" :disabled="booking.status !== 'Pending'" class="text-green-600 hover:text-green-800 disabled:opacity-50 disabled:cursor-not-allowed">
                        <i class="fas fa-check"></i>
                      </button>
                      <button @click="cancelBooking(booking.id)" :disabled="booking.status === 'Cancelled'" class="text-red-600 hover:text-red-800 disabled:opacity-50 disabled:cursor-not-allowed">
                        <i class="fas fa-times"></i>
                      </button>
                    </div>
                  </td>
                </tr>
              </template>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Live Tracking Admin -->
      <div x-show="activeTab === 'tracking'" class="bg-white rounded-2xl shadow-lg p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-6">Live Vehicle Tracking</h3>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <div>
            <div class="bg-gray-50 rounded-xl p-4 mb-4">
              <h4 class="font-bold text-gray-800 mb-3">Active Vehicles</h4>
              <div class="space-y-3">
                <template x-for="bus in adminBuses.filter(b => b.status === 'Active')" :key="bus.id">
                  <div class="flex items-center justify-between p-3 bg-white rounded-lg shadow-sm">
                    <div class="flex items-center space-x-3">
                      <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                      <div>
                        <div class="font-medium text-gray-800" x-text="bus.number"></div>
                        <div class="text-sm text-gray-500" x-text="bus.route"></div>
                      </div>
                    </div>
                    <button @click="adminTrackBus = bus" class="text-blue-600 hover:text-blue-800">
                      <i class="fas fa-map-marked-alt"></i>
                    </button>
                  </div>
                </template>
              </div>
            </div>
          </div>
          
          <div x-show="adminTrackBus" class="bg-gray-50 rounded-xl p-4">
            <div class="flex items-center justify-between mb-3">
              <h4 class="font-bold text-gray-800" x-text="adminTrackBus?.number"></h4>
              <button @click="adminTrackBus = null" class="text-gray-500 hover:text-gray-700">
                <i class="fas fa-times"></i>
              </button>
            </div>
            
            <div class="space-y-3 text-sm">
              <div class="flex justify-between">
                <span class="text-gray-600">Route:</span>
                <span x-text="adminTrackBus?.route"></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Driver:</span>
                <span x-text="adminTrackBus?.driver || 'Not Assigned'"></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Last Update:</span>
                <span>Just now</span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Speed:</span>
                <span x-text="Math.floor(Math.random() * 60) + 40 + ' km/h'"></span>
              </div>
            </div>
            
            <div class="mt-4 map-container" style="height: 200px;">
              <div class="absolute top-4 left-4 text-white font-medium" x-text="adminTrackBus?.route?.split('→')[0]"></div>
              <div class="absolute top-4 right-4 text-white font-medium" x-text="adminTrackBus?.route?.split('→')[1]"></div>
              
              <div class="route-line" style="width: 80%; left: 10%; top: 50%;"></div>
              
              <div class="absolute" style="left: 45%; top: 48%;">
                <div class="bus-icon">🚌</div>
              </div>
              
              <div class="tracking-point" style="left: 45%; top: 48%;"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Reports -->
      <div x-show="activeTab === 'reports'" class="bg-white rounded-2xl shadow-lg p-6">
        <h3 class="text-lg font-bold text-gray-800 mb-6">Analytics & Reports</h3>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- Revenue Chart -->
          <div class="bg-gray-50 rounded-xl p-6">
            <h4 class="font-bold text-gray-800 mb-4">Monthly Revenue</h4>
            <div class="space-y-3">
              <template x-for="month in ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun']" :key="month">
                <div class="flex items-center space-x-3">
                  <span class="text-sm text-gray-600 w-12" x-text="month"></span>
                  <div class="flex-1 bg-gray-200 rounded-full h-2">
                    <div class="bg-blue-500 h-2 rounded-full" :style="'width: ' + (Math.random() * 80 + 20) + '%'"></div>
                  </div>
                </div>
              </template>
            </div>
          </div>
          
          <!-- Occupancy Rate -->
          <div class="bg-gray-50 rounded-xl p-6">
            <h4 class="font-bold text-gray-800 mb-4">Bus Occupancy Rate</h4>
            <div class="space-y-4">
              <template x-for="bus in adminBuses.slice(0, 4)" :key="bus.id">
                <div class="flex items-center justify-between">
                  <span class="text-sm font-medium text-gray-700" x-text="bus.name"></span>
                  <div class="flex items-center space-x-2">
                    <div class="w-20 bg-gray-200 rounded-full h-2">
                      <div class="bg-green-500 h-2 rounded-full" :style="'width: ' + (Math.random() * 70 + 30) + '%'"></div>
                    </div>
                    <span class="text-sm text-gray-600" x-text="Math.floor(Math.random() * 70 + 30) + '%'"></span>
                  </div>
                </div>
              </template>
            </div>
          </div>
        </div>
        
        <!-- Quick Stats -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
          <div class="bg-blue-50 p-4 rounded-xl">
            <div class="text-sm text-blue-600 font-medium">Total Revenue</div>
            <div class="text-2xl font-bold text-blue-800">₹2.4L</div>
            <div class="text-sm text-green-600">↑ 12% from last month</div>
          </div>
          <div class="bg-green-50 p-4 rounded-xl">
            <div class="text-sm text-green-600 font-medium">Bookings This Month</div>
            <div class="text-2xl font-bold text-green-800">1,248</div>
            <div class="text-sm text-green-600">↑ 8% from last month</div>
          </div>
          <div class="bg-purple-50 p-4 rounded-xl">
            <div class="text-sm text-purple-600 font-medium">Avg. Occupancy</div>
            <div class="text-2xl font-bold text-purple-800">76%</div>
            <div class="text-sm text-green-600">↑ 5% from last month</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('alpine:init', () => {
      Alpine.data('app', () => ({
        view: 'customer',
        isLoggedIn: false,
        user: {
          name: 'John Doe',
          phone: '9876543210'
        },
        
        login: {
          phone: '',
          password: ''
        },
        
        search: {
          from: 'Delhi',
          to: 'Mumbai',
          date: new Date().toISOString().split('T')[0]
        },
        
        searchResults: [],
        selectedBus: null,
        selectedSeats: [],
        bookingConfirmed: false,
        currentBooking: {},
        userBookings: [],
        
        trackingBus: null,
        trackingProgress: 35,
        currentLocation: 'Noida, UP',
        estimatedArrival: '2:45 PM',
        busStatus: 'On Time',
        
        // Admin Data
        activeTab: 'buses',
        showAddBus: false,
        editingBus: null,
        busForm: {},
        adminBuses: [
          { id: 1, number: 'DL1C 1234', name: 'Royal Express', type: 'AC Sleeper', route: 'Delhi → Mumbai', fare: 1200, status: 'Active', totalSeats: 40, bookedSeats: [2, 5, 8, 12, 15, 18, 22, 25, 28, 32, 35, 38] },
          { id: 2, number: 'MH5X 5678', name: 'Swift Travels', type: 'Semi-Sleeper', route: 'Mumbai → Bangalore', fare: 900, status: 'Active', totalSeats: 45, bookedSeats: [3, 7, 11, 14, 19, 23, 27, 31, 36, 40] },
          { id: 3, number: 'KA01 9012', name: 'Comfort Plus', type: 'Luxury', route: 'Bangalore → Chennai', fare: 850, status: 'Maintenance', totalSeats: 36, bookedSeats: [1, 6, 10, 13, 17, 21, 26, 30, 34] },
          { id: 4, number: 'TN09 3456', name: 'Eagle Coach', type: 'Non-AC Seater', route: 'Chennai → Delhi', fare: 1500, status: 'Active', totalSeats: 50, bookedSeats: [4, 9, 16, 20, 24, 29, 33, 37, 41, 45] },
          { id: 5, number: 'WB45 7890', name: 'Golden Route', type: 'AC Sleeper', route: 'Kolkata → Mumbai', fare: 1300, status: 'Inactive', totalSeats: 42, bookedSeats: [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41] }
        ],
        adminBookings: [
          { id: 'BK001', customer: 'Alice Johnson', bus: 'Royal Express', date: '2023-12-15', seats: 'A12, A13', total: '₹2400', status: 'Confirmed' },
          { id: 'BK002', customer: 'Bob Smith', bus: 'Swift Travels', date: '2023-12-16', seats: 'B05', total: '₹900', status: 'Pending' },
          { id: 'BK003', customer: 'Carol Davis', bus: 'Comfort Plus', date: '2023-12-17', seats: 'C08, C09, C10', total: '₹2550', status: 'Confirmed' },
          { id: 'BK004', customer: 'David Wilson', bus: 'Eagle Coach', date: '2023-12-18', seats: 'D22', total: '₹1500', status: 'Cancelled' },
          { id: 'BK005', customer: 'Eva Brown', bus: 'Golden Route', date: '2023-12-19', seats: 'E15, E16', total: '₹2600', status: 'Confirmed' },
          { id: 'BK006', customer: 'Frank Miller', bus: 'Royal Express', date: '2023-12-20', seats: 'A03', total: '₹1200', status: 'Pending' }
        ],
        adminTrackBus: null,
        
        init() {
          // Set default date to tomorrow
          const tomorrow = new Date();
          tomorrow.setDate(tomorrow.getDate() + 1);
          this.search.date = tomorrow.toISOString().split('T')[0];
          
          // Simulate some user bookings
          this.userBookings = [
            { id: 'BK001', bus: 'Royal Express', route: 'Delhi → Mumbai', date: 'Dec 15, 2023', seats: 'A12, A13', total: '₹2400', status: 'Confirmed' },
            { id: 'BK003', bus: 'Comfort Plus', route: 'Bangalore → Chennai', date: 'Dec 17, 2023', seats: 'C08, C09, C10', total: '₹2550', status: 'Confirmed' }
          ];
          
          // Simulate tracking animation
          setInterval(() => {
            if (this.trackingBus) {
              this.trackingProgress = Math.min(100, this.trackingProgress + Math.random() * 2);
              if (this.trackingProgress >= 100) {
                this.trackingProgress = 0;
                this.currentLocation = this.search.to;
                this.estimatedArrival = 'Arrived';
                this.busStatus = 'Completed';
              } else {
                const locations = ['Noida, UP', 'Agra, UP', 'Gwalior, MP', 'Indore, MP', 'Surat, Gujarat', 'Vadodara, Gujarat', 'Mumbai, Maharashtra'];
                this.currentLocation = locations[Math.floor(this.trackingProgress / 20)] || 'En route';
              }
            }
          }, 3000);
        },
        
        loginUser() {
          if (this.login.phone && this.login.password) {
            this.isLoggedIn = true;
            this.searchBuses();
          }
        },
        
        logout() {
          this.isLoggedIn = false;
          this.view = 'customer';
          this.selectedBus = null;
          this.selectedSeats = [];
          this.bookingConfirmed = false;
          this.trackingBus = null;
        },
        
        searchBuses() {
          this.searchResults = this.adminBuses.filter(bus => {
            const route = bus.route.split('→').map(r => r.trim());
            return route[0].includes(this.search.from) && route[1].includes(this.search.to) && bus.status === 'Active';
          }).map(bus => ({
            ...bus,
            departure: '08:00 AM',
            arrival: '08:00 PM',
            duration: '12h',
            seatsAvailable: bus.totalSeats - bus.bookedSeats.length
          }));
        },
        
        selectBus(bus) {
          this.selectedBus = bus;
          this.selectedSeats = [];
        },
        
        toggleSeat(seatNumber) {
          if (this.selectedBus.bookedSeats.includes(seatNumber)) return;
          
          const index = this.selectedSeats.indexOf(seatNumber);
          if (index > -1) {
            this.selectedSeats.splice(index, 1);
          } else {
            this.selectedSeats.push(seatNumber);
          }
        },
        
        bookSeats() {
          if (this.selectedSeats.length === 0) return;
          
          const booking = {
            id: 'BK' + Math.floor(1000 + Math.random() * 9000),
            bus: this.selectedBus.name,
            route: this.search.from + ' → ' + this.search.to,
            date: this.formatDate(this.search.date),
            seats: this.selectedSeats.join(', '),
            total: '₹' + (this.selectedBus.fare * this.selectedSeats.length),
            status: 'Confirmed'
          };
          
          this.currentBooking = booking;
          this.bookingConfirmed = true;
          this.userBookings.unshift(booking);
          
          // Add to admin bookings
          this.adminBookings.unshift({
            ...booking,
            customer: this.user.name,
            id: booking.id
          });
          
          // Update booked seats
          this.selectedBus.bookedSeats.push(...this.selectedSeats);
          this.selectedSeats = [];
          this.selectedBus = null;
        },
        
        trackBus(bus) {
          this.trackingBus = bus;
          this.trackingProgress = 35;
          this.currentLocation = 'Noida, UP';
          this.estimatedArrival = '2:45 PM';
          this.busStatus = 'On Time';
        },
        
        // Admin Methods
        editBus(bus) {
          this.editingBus = { ...bus };
          this.busForm = { ...bus };
          this.showAddBus = true;
        },
        
        deleteBus(id) {
          if (confirm('Are you sure you want to delete this bus?')) {
            this.adminBuses = this.adminBuses.filter(bus => bus.id !== id);
            this.adminBookings = this.adminBookings.filter(booking => !booking.bus.includes(this.adminBuses.find(b => b.id === id)?.name));
          }
        },
        
        saveBus() {
          if (this.editingBus) {
            // Update existing bus
            const index = this.adminBuses.findIndex(b => b.id === this.editingBus.id);
            if (index > -1) {
              this.adminBuses[index] = { ...this.adminBuses[index], ...this.busForm };
            }
            this.editingBus = null;
          } else {
            // Add new bus
            const newBus = {
              id: Math.max(...this.adminBuses.map(b => b.id)) + 1,
              totalSeats: 40,
              bookedSeats: [],
              ...this.busForm
            };
            this.adminBuses.push(newBus);
          }
          
          this.busForm = {};
          this.showAddBus = false;
        },
        
        confirmBooking(id) {
          const booking = this.adminBookings.find(b => b.id === id);
          if (booking) {
            booking.status = 'Confirmed';
          }
        },
        
        cancelBooking(id) {
          const booking = this.adminBookings.find(b => b.id === id);
          if (booking) {
            booking.status = 'Cancelled';
          }
        },
        
        formatDate(dateString) {
          return new Date(dateString).toLocaleDateString('en-IN', {
            day: 'numeric',
            month: 'short',
            year: 'numeric'
          });
        }
      }));
    });
  </script>
</body>
</html>
